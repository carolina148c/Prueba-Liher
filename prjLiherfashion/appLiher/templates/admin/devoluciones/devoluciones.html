{% extends 'admin/includes/base_admin.html' %}
{% load static %}

{% block title %}Devoluciones{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/secciones_admin.css' %}">
{% endblock %}

{% block header_title %}DEVOLUCIONES{% endblock %}

{% block main_content %}
<div class="container">

    <!-- Estadísticas -->
    <div class="stats">
        <div class="stat-item inventory-low" data-filter="pendiente" style="cursor: pointer;" onclick="filterByStatus('pendiente')">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            </div>
            <div class="stat-content">
                <div class="stat-number">128</div>
                <div class="stat-label">Pendientes</div>
            </div>
        </div>

        <div class="stat-item stat-active" data-filter="aprobada" style="cursor: pointer;" onclick="filterByStatus('aprobada')">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
            </div>
            <div class="stat-content">
                <div class="stat-number">24,680</div>
                <div class="stat-label">Aprobadas</div>
            </div>
        </div>

        <div class="stat-item stat-total" data-filter="proceso" style="cursor: pointer;" onclick="filterByStatus('proceso')">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                </svg>
            </div>
            <div class="stat-content">
                <div class="stat-number">-</div>
                <div class="stat-label">En proceso</div>
            </div>
        </div>

        <div class="stat-item stat-inactive" data-filter="rechazada" style="cursor: pointer;" onclick="filterByStatus('rechazada')">
            <div class="stat-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="15" y1="9" x2="9" y2="15"></line>
                    <line x1="9" y1="9" x2="15" y2="15"></line>
                </svg>
            </div>
            <div class="stat-content">
                <div class="stat-number">3</div>
                <div class="stat-label">Rechazadas</div>
            </div>
        </div>
    </div>

    <!-- Mensajes -->
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li class="{{ message.tags }}">{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <!-- Filtros -->
    <div class="search-filter-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <div style="grid-column: 1 / -1;">
            <div class="search-bar">
                <input type="text" placeholder="Buscar por número de pedido o cliente..." id="searchInput">
                <span class="search-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </span>
            </div>
        </div>

        <select class="filter-dropdown" id="statusFilter">
            <option value="">Todos los estados</option>
            <option value="pendiente">Pendiente</option>
            <option value="aprobada">Aprobada</option>
            <option value="proceso">En Proceso</option>
            <option value="rechazada">Rechazada</option>
        </select>

        <input type="text" class="filter-dropdown" id="clientFilter" placeholder="Buscar por cliente">
        <input type="text" class="filter-dropdown" id="orderFilter" placeholder="Nº de Pedido (ej. ORD-001)">
        <input type="date" class="filter-dropdown" id="dateFrom">
        <input type="date" class="filter-dropdown" id="dateTo">
    </div>

    <!-- Botones de filtro -->
    <div class="action-buttons" style="justify-content: flex-start; margin-top: 0;">
        <button class="btn-primary" id="btn-apply-filters">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            Aplicar Filtros
        </button>
        <button class="btn-outline" id="btn-clear-filters">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
            Limpiar Filtros
        </button>
    </div>

    <!-- Info de actualización -->
    <div style="text-align: right; color: #7f8c8d; font-size: 13px; margin-bottom: 20px;">
        Total de devoluciones: <strong>24,811</strong>
    </div>

    <!-- Tabla -->
    <div class="table-container">
        <table class="returns-table">
            <thead>
                <tr>
                    <th>Nº Pedido</th>
                    <th>Cliente</th>
                    <th>Fecha Solicitud</th>
                    <th>Productos Devueltos</th>
                    <th>Estado</th>
                    <th>Monto Devolución</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <strong style="color: #FF4081; font-weight: 600;">#12345</strong>
                    </td>
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">AC</div>
                            <div class="user-info">
                                <div class="user-name">Ana Carolina Correa</div>
                                <div class="user-email">ana2007@gmail.com</div>
                            </div>
                        </div>
                    </td>
                    <td>21/06/2025</td>
                    <td><strong>2 productos</strong></td>
                    <td>
                        <span class="status-badge status-pending">Pendiente</span>
                    </td>
                    <td><strong style="color: #2c3e50;">$150.00</strong></td>
                    <td>
                        <div class="table-actions">
                            <button class="view-btn" onclick="viewReturn('12345')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                Ver
                            </button>
                            <button class="edit-btn" onclick="approveReturn('12345')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                </svg>
                                Aprobar
                            </button>
                            <button class="delete-btn" onclick="return confirm('¿Rechazar devolución #12345?') && rejectReturn('12345')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="15" y1="9" x2="9" y2="15"></line>
                                    <line x1="9" y1="9" x2="15" y2="15"></line>
                                </svg>
                                Rechazar
                            </button>
                        </div>
                    </td>
                </tr>

                <tr>
                    <td>
                        <strong style="color: #FF4081; font-weight: 600;">#12346</strong>
                    </td>
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">SM</div>
                            <div class="user-info">
                                <div class="user-name">Santiago Meza</div>
                                <div class="user-email">santiago.m@example.com</div>
                            </div>
                        </div>
                    </td>
                    <td>21/06/2025</td>
                    <td><strong>2 productos</strong></td>
                    <td>
                        <span class="status-badge status-active">Aprobada</span>
                    </td>
                    <td><strong style="color: #2c3e50;">$230.00</strong></td>
                    <td>
                        <div class="table-actions">
                            <button class="view-btn" onclick="viewReturn('12346')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                Ver
                            </button>
                        </div>
                    </td>
                </tr>

                <tr>
                    <td>
                        <strong style="color: #FF4081; font-weight: 600;">#12347</strong>
                    </td>
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">DO</div>
                            <div class="user-info">
                                <div class="user-name">Damian Ortiz</div>
                                <div class="user-email">damian.ortiz@example.com</div>
                            </div>
                        </div>
                    </td>
                    <td>21/06/2025</td>
                    <td><strong>1 producto</strong></td>
                    <td>
                        <span class="status-badge status-inactive">Rechazada</span>
                    </td>
                    <td><strong style="color: #2c3e50;">$0.00</strong></td>
                    <td>
                        <div class="table-actions">
                            <button class="view-btn" onclick="viewReturn('12347')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                Ver
                            </button>
                        </div>
                    </td>
                </tr>

                <tr>
                    <td>
                        <strong style="color: #FF4081; font-weight: 600;">#12348</strong>
                    </td>
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">LR</div>
                            <div class="user-info">
                                <div class="user-name">Laura Ramírez</div>
                                <div class="user-email">laura.r@example.com</div>
                            </div>
                        </div>
                    </td>
                    <td>20/06/2025</td>
                    <td><strong>3 productos</strong></td>
                    <td>
                        <span class="status-badge status-shipped">En Proceso</span>
                    </td>
                    <td><strong style="color: #2c3e50;">$450.00</strong></td>
                    <td>
                        <div class="table-actions">
                            <button class="view-btn" onclick="viewReturn('12348')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                                Ver
                            </button>
                            <button class="edit-btn" onclick="processReturn('12348')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                                </svg>
                                Procesar
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Paginación -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 30px; flex-wrap: wrap; gap: 15px;">
            <div style="color: #7f8c8d; font-size: 14px;">
                Mostrando 4 de 24,811 devoluciones
            </div>
            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                <button class="btn-outline" style="padding: 10px 16px; font-size: 13px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Anterior
                </button>
                <button class="btn-primary" style="padding: 10px 16px; font-size: 13px; min-width: 40px;">1</button>
                <button class="btn-outline" style="padding: 10px 16px; font-size: 13px; min-width: 40px;">2</button>
                <button class="btn-outline" style="padding: 10px 16px; font-size: 13px; min-width: 40px;">3</button>
                <span style="color: #7f8c8d; padding: 0 5px;">...</span>
                <button class="btn-outline" style="padding: 10px 16px; font-size: 13px; min-width: 40px;">500</button>
                <button class="btn-outline" style="padding: 10px 16px; font-size: 13px;">
                    Siguiente
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/devoluciones.js' %}"></script>
<script>
function filterByStatus(status) {
    const statusFilter = document.getElementById('statusFilter');
    if (statusFilter) {
        statusFilter.value = status;
        applyFilters();
    }
}

function applyFilters() {
    console.log('Aplicando filtros...');
}

function viewReturn(id) {
    console.log('Ver devolución:', id);
}

function approveReturn(id) {
    alert('Devolución #' + id + ' aprobada');
}

function rejectReturn(id) {
    alert('Devolución #' + id + ' rechazada');
}

function processReturn(id) {
    alert('Procesando devolución #' + id);
}

document.getElementById('btn-apply-filters').addEventListener('click', applyFilters);

document.getElementById('btn-clear-filters').addEventListener('click', function() {
    document.getElementById('searchInput').value = '';
    document.getElementById('statusFilter').value = '';
    document.getElementById('clientFilter').value = '';
    document.getElementById('orderFilter').value = '';
    document.getElementById('dateFrom').value = '';
    document.getElementById('dateTo').value = '';
});
</script>
{% endblock %}